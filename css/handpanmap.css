/* Handpan Image Section */
.main{
    display:flex;
    gap:24px;
    align-items:flex-start;
  }

  .left{
    flex: 1 1 auto;
    min-width: 0;
  }

  .handpan-panel{
    flex: 0 0 340px;
    position: sticky;
    top: 16px;
    align-self: flex-start;
  }

  .handpan-wrap{
    position: relative;
    width: 100%;
    border-radius: 18px;
    background: var(--panel);
    border: 1px solid var(--panel-border);
    padding: 14px;
  }

  .handpan-img{
    width: 100%;
    height: auto;
    display:block;
    border-radius: 14px;
  }

  .handpan-overlay{
    position:absolute;
    inset: 14px; /* match padding so overlay sits on top of image area */
    pointer-events:none;
  }

  /* Mobile: stack */
  @media (max-width: 900px){
    .main{ flex-direction: column; }
    .handpan-panel{ position: static; width: 100%; flex: none; }
  }
  
  /* Overlays */

  /* :root{
    --downbeat-color: rgba(79, 17, 48, 0.12);
    --upbeat-color: rgb(2, 68, 150);
  }
  body.dark{
    --downbeat-color: #ffd166;
    --upbeat-color: #7fa67a;
  } */

  .hp-dot{
    position:absolute;
    border-radius: 50%;
    opacity: 0.0;              /* hidden until active */
    transition: opacity 120ms ease;
  }
  
  /* body:not(.dark) .hp-dot{ */
    /* border-color: rgba(47,47,47,0.55); */
    /* background: rgba(79, 17, 48, 0.50); */
  /* } */
  
  .hp-dot.active{
    opacity: 1;
    animation: hpPulse 180ms ease-out;
    box-shadow: 0 0 0 5px rgba(79, 17, 48, 0.18);
  }
  
  @keyframes hpPulse{
    0%   { transform: translate(-50%, -50%) scale(1); }
    60%  { transform: translate(-50%, -50%) scale(1.18); }
    100% { transform: translate(-50%, -50%) scale(1); }
  }
  
  .hp-dot{
    border: 2px solid rgba(255,255,255,0.65);
    background: rgba(255,255,255,0.06);
  }
  
  body:not(.dark) .hp-dot{
    border-color: rgba(47,47,47,0.55);
  }
  

  /* Color comes from class */
  .hp-dot.hp-down{
    border-color: color-mix(in srgb, var(--down-fill) 70%, transparent);
    background: color-mix(in srgb, var(--down-fill) 50%, transparent);
  }
  .hp-dot.hp-up{
    border-color: color-mix(in srgb, var(--up-fill) 70%, transparent);
    background: color-mix(in srgb, var(--up-fill) 50%, transparent);
  }
  
  .hp-dot.active.hp-down{
    box-shadow: 0 0 0 10px color-mix(in srgb, var(--down-fill) 22%, transparent);
  }
  .hp-dot.active.hp-up{
    box-shadow: 0 0 0 10px color-mix(in srgb, var(--up-fill) 22%, transparent);
  }

  
  /* Calibration */

  /* Enable clicking dots only when calibrating */
body .handpan-overlay { pointer-events: auto; }

/* Make dots visible while calibrating (even when not playing) */
body.calibrating .hp-dot { opacity: 0.55; }

/* Selected dot styling */
body.calibrating .hp-dot.selected {
  opacity: 1;
  outline: 3px solid rgba(255, 209, 102, 0.9);
  outline-offset: 2px;
  box-shadow: 0 0 0 10px rgba(255, 209, 102, 0.18);
}

/* Dark mode outline tweak */
body.dark.calibrating .hp-dot.selected {
  outline-color: rgba(91, 140, 255, 0.95);
  box-shadow: 0 0 0 10px rgba(91, 140, 255, 0.20);
}
